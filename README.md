# LiteLoaderQQNT - background-plugin

LiteLoaderQQNT插件，用于自动轮换QQNT的背景图片，并自带一些CSS透明度优化（参考自[LiteLoaderQQNT-Test-Theme](https://github.com/mo-jinran/test-theme)）。
使用前需要安装[LiteLoaderQQNT](https://github.com/mo-jinran/LiteLoaderQQNT)，并在QQNT新版上使用。

## 使用方法

*建议从`LiteLoaderQQNT`应用商店中直接下载安装，方便快捷。*（新版本1.0`LiteLoaderQQNT`没有插件商店了，请遵循[手动安装方法](https://liteloaderqqnt.github.io/guide/plugins.html)）

版本不兼容提示：从0.1.18起，插件已适配1.0版本以上`LiteLoaderQQNT`框架，同时不再兼容旧版框架，请遵循[安装方法](https://liteloaderqqnt.github.io/guide/install.html)更新框架。



也可以clone或下载zip文件解压，保留文件夹结构（文件夹名称为`插件名`，内容为github上的内容），将文件夹移动至`LiteLoaderQQNT数据目录/plugins/`下面，重启QQNT即可。

- 启动QQ后会自动写入默认配置文件到**插件目录下面的`config.json`**，然后你对配置文件做的任何修改都会被插件实时应用（详见后文）。若无必要，不建议手动修改`config.json`；
- 你还可以通过QQ设置里的背景插件设置界面对插件进行设置（推荐这种方法，更方便，也能实时应用）。

**如果出现错乱、设置修改后无法应用或无法加载背景图的情况，请确认`config.json`是否被正确配置；若不能确定，可先前往设置界面恢复默认设置；如果连设置界面也进不去，那就手动删除`config.json`后重启NTQQ再试（恢复默认后无背景图，请去设置背景图后再看看有没有问题），若还有问题请发ISSUE。**

可搭配[MSpring主题](https://github.com/MUKAPP/LiteLoaderQQNT-MSpring-Theme)实现更佳效果哦~

默认加载图片的路径是插件目录下面的imgs文件夹，在QQ的设置里可以切换背景图片的目录，保存后下次更新图片时生效，目前只会读取目录同级的一些常见格式的图片文件，如下：

`const allowedExt = ["JPG", "BMP", "PNG", "WEBP", "JPEG"];  `

图片默认是居中适应，所以如果比例不对可能会不好看，尽量选择横着的图片吧~

**目前已支持从网络API获取图片，详见下面的配置说明。**

现在深色浅色模式会根据`@media`媒体选择器自适应啦~

目前还很简陋，代码也比较粗糙，但能用！

## 配置说明

**注意：所有涉及到路径的字符串中的斜杠都是正斜杠（/）。**

*所有直接对配置文件的直接修改都会导致立即重置计时器并更新一张背景图（因为无法确定你修改了哪一部分，所以只能全部重载），而在配置界面的修改只会立即应用修改的那一部分。*

imgDir（对应配置界面`本地背景图文件夹路径`）：从哪个文件夹自动读取图片文件，仅会读取一级的图片，并不会递归读取子文件夹的哦。默认：`插件目录下面的imgs文件夹`。**指定单张背景图请使用imgFile参数（相较旧版本已修改）。**

imgApi（对应配置界面`网络背景图链接`）：从哪个api获取网络图片，可选，可以没有这一项，但图片来源为网络图片时该项必填。从网络获取的图片必须没有防盗链，可通过GET直接访问（也就是链接放到浏览器里直接就能打开看到图片），暂不支持JSON格式返回的API（后续将支持）。默认：`""`。

imgFile（对应配置界面`本地背景图路径`）：背景图设置为哪个单独文件，可选，可以没有这一项，但图片来源为文件时该项必填。默认：`""`。

imgSource（对应配置界面`修改背景图来源`）：图片来源类型，是文件夹轮播，还是单张背景图，还是从网络api获取。可选值：folder→文件夹；file→单个文件；network→网络图片。默认：`folder`。

refreshTime（对应配置界面`背景图更新间隔`）：多久随机更新一次图片，单位秒。默认：`600`（10分钟）。

isAutoRefresh（对应配置界面`是否自动轮播背景图`）：是否自动轮播背景图。若关闭，则每次NTQQ启动仅随机一次图片，后续除非手动点击按钮更新，否则不再更新。默认：`true`。

enableFrostedGlassStyle（对应配置界面`是否对部分组件启用毛玻璃模糊效果`）：是否对部分组件启用毛玻璃模糊效果，若不喜欢可以关闭。你可以通过开关来对比效果，因为配置修改是实时生效的。默认：`true`。

overrideImgFile（暂无配置界面对应）：无论上面图片来源设置如何，强制使用本参数提供的图片文件路径作为背景图。这个参数是用来配合未来手动选择文件夹内某张图片作为背景图使用的（目前该功能还没有实装）。默认：`""`。

apiOptions对象：用来配置来源是网络图片的请求。

​	useCache（对应配置界面`是否启用缓存`）：若来源是网络图片，是否使用缓存。如果你设置的图片地址是API（也就是每次请求图片不一样），请务必设置为`false`，否则，缓存将导致图片不会更新；若你设置的图片地址为单张图片，每次请求均一样，可以设置为`true`来避免重复请求*（原理：每次请求会带上一个t=时间戳的参数，这样就能避免缓存）*。默认：`false`。

## 协议及免责

MIT | 禁止用于任何非法用途，插件开发属学习与研究目的，仅自用，未提供给任何第三方使用。任何不当使用导致的任何侵权问题责任自负。
